# 画像メタデータ管理ガイド

## 概要

このガイドは、飛行ロボットコンテストのルール管理システムにおける画像メタデータの管理方法について説明します。メタデータは画像の検索性と管理性を向上させるために重要な役割を果たします。

## メタデータの構造

画像メタデータは以下の形式で保存されています：

```json
{
  "filename": "カテゴリ-内容-年度.拡張子",
  "filepath": "docs\\images\\カテゴリ\\カテゴリ-内容-年度.拡張子",
  "description": "画像の説明",
  "categories": ["カテゴリ"],
  "divisions": ["適用部門"],
  "year": 20XX,
  "tags": ["タグ1", "タグ2"],
  "last_updated": "YYYY-MM-DD HH:MM:SS"
}
```

### 主要フィールドの説明

- **filename**: ファイル名（命名規則：カテゴリ-内容-年度.拡張子）
- **filepath**: ファイルの相対パス
- **description**: 画像の説明文（任意）
- **categories**: 画像のカテゴリ（field, equipment, missions等）
- **divisions**: 適用される部門（一般部門、自動操縦部門、マルチコプター部門、ビギナー部門等）
- **year**: 画像の適用年度
- **tags**: 検索用タグ（任意）
- **last_updated**: 最終更新日時

## メタデータファイル

メタデータは以下のファイルで管理されています：

- `images_metadata.json` - すべての画像のメタデータ
- `metadata_field.json` - フィールド関連画像のメタデータ
- `metadata_equipment.json` - 装置・機材関連画像のメタデータ
- `metadata_missions.json` - ミッション関連画像のメタデータ
- `metadata_all.json` - すべてのメタデータを含む統合ファイル

## メタデータの更新方法

### 手動更新

1. 対応するメタデータJSONファイルを開く
2. 必要な変更を加える
3. 更新日時を現在の日時に変更する
4. 変更内容を`METADATA_UPDATE_PROGRESS.md`に記録する

### 自動更新

メタデータの自動生成・更新には以下のスクリプトを使用できます：

```bash
# メタデータを生成・更新するバッチファイル
generate_metadata.bat
```

または、Node.jsスクリプトを直接実行：

```bash
node docs/tools/create-metadata.js
```

## 部門情報（divisions）の管理

部門情報は以下のいずれかの値を配列で指定します：

- `一般部門`
- `自動操縦部門`
- `マルチコプター部門`
- `ビギナー部門`

例：
```json
"divisions": ["一般部門", "ビギナー部門"]
```

## メタデータ更新の記録

メタデータを更新する際は、変更内容を `METADATA_UPDATE_PROGRESS.md` に記録してください。
以下の形式での記録を推奨します：

```markdown
## YYYY-MM-DD 更新内容

### 修正内容
- 〇〇画像の部門情報を更新
- △△画像の説明を追加

### 詳細
- equipment-XX-YYYY.png: 部門情報に「一般部門」を追加
- field-YY-YYYY.png: 説明文を「～」に変更
```

## メタデータの活用

メタデータは以下の目的で活用できます：

1. 特定の部門やカテゴリに関連する画像の検索
2. 画像の更新履歴の追跡
3. ルール文書内の画像参照の自動更新
4. 年度ごとの画像リストの生成

## エラーと問題の解決

メタデータの更新中に問題が発生した場合：

1. JSONファイルの構文を確認する
2. ファイルパスが正確であることを確認する
3. 必須フィールドがすべて含まれていることを確認する
4. イシューを作成し、詳細な問題の説明を提供する

---

最終更新日: 2025年3月10日
